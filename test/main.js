"use strict";
var chai = require("chai");
var child_process = require("child_process");
var exec = child_process.exec;
var rpj = require("request-promise-json");
var expect = chai.expect;
var CouchMan = require("../index");
var startPouchServer = require('spawn-pouchdb-server');
before(function (done) {
    exec("rm -rf .db", function () {
        startPouchServer({
            config: {
                file: false,
                log: {
                    file: false
                }
            }
        }, function (error, pouch) {
            if (error) {
                done(error);
            }
            done();
        });
    });
});
describe("test new event creation", function () {
    var obj;
    before(function (done) {
        rpj.put('http://localhost:5985/test-db-create').then(function (d) {
            var CM = new CouchMan({ couch: "http://localhost:5985/test-db-create" });
            var newobj = CM.gen({ class: "event" });
            CM.create(newobj).then(function (_id) {
                CM.find(_id).then(function (obje) {
                    obj = obje;
                    done();
                }).catch(function (err) {
                    done(err);
                });
            }).catch(function (err) {
                done(err);
            });
        }).catch(function (err) {
            done(err);
        });
    });
    it("expect an object", function () {
        expect(obj).to.be.an("Object");
    });
    describe("composition of _id", function () {
        it("expect that _id is composed of 4 word", function () {
            expect(obj._id.split("_").length).that.equal(4);
        });
        it("expect that first word of _id is class event", function () {
            expect(obj._id.split("_")[0]).that.equal("event");
        });
        it("expect that second word of _id is serial 00000", function () {
            expect(obj._id.split("_")[1]).that.equal("00000");
        });
        it("expect that third word of _id is a number equal to createdAt", function () {
            expect(parseInt(obj._id.split("_")[2])).that.is.a("number").that.equal(obj.createdAt);
        });
        it("expect fourth word of _id is an uid", function () {
            expect(obj._id.split("_")[3]).that.is.a("string");
        });
        it("expect fourth word of _id is an uid of 5 characters", function () {
            expect(obj._id.split("_")[3].length).that.equal(5);
        });
    });
});
describe("test edit event object", function () {
    var obj;
    before(function (done) {
        rpj.put('http://localhost:5985/test-db-edit').then(function (d) {
            var CM = new CouchMan({ couch: "http://localhost:5985/test-db-edit" });
            var newobj = CM.gen({ class: "event" });
            CM.create(newobj).then(function (_id) {
                CM.find(_id).then(function (obje) {
                    CM.update(obje).then(function () {
                        obj = obje;
                        done();
                    }).catch(function (err) {
                        done(err);
                    });
                }).catch(function (err) {
                    done(err);
                });
            }).catch(function (err) {
                done(err);
            });
        }).catch(function (err) {
            done(err);
        });
    });
    it("expect an object", function () {
        expect(obj).to.be.an("Object");
    });
    describe("composition of _id", function () {
        it("expect that _id is composed of 4 word", function () {
            expect(obj._id.split("_").length).that.equal(4);
        });
        it("expect that first word of _id is class event", function () {
            expect(obj._id.split("_")[0]).that.equal("event");
        });
        it("expect that second word of _id is serial 00000", function () {
            expect(obj._id.split("_")[1]).that.equal("00000");
        });
        it("expect that third word of _id is a number equal to createdAt", function () {
            expect(parseInt(obj._id.split("_")[2])).that.is.a("number").that.equal(obj.createdAt);
        });
        it("expect fourth word of _id is an uid", function () {
            expect(obj._id.split("_")[3]).that.is.a("string");
        });
        it("expect fourth word of _id is an uid of 5 characters", function () {
            expect(obj._id.split("_")[3].length).that.equal(5);
        });
    });
});
describe("test edit data object", function () {
    var obj;
    before(function (done) {
        rpj.put('http://localhost:5985/test-db-data').then(function (d) {
            var CM = new CouchMan({ couch: "http://localhost:5985/test-db-data" });
            var newobj = CM.gen();
            CM.create(newobj).then(function (_id) {
                CM.find(_id).then(function (obje) {
                    CM.update(obje).then(function () {
                        obj = obje;
                        done();
                    }).catch(function (err) {
                        done(err);
                    });
                }).catch(function (err) {
                    done(err);
                });
            }).catch(function (err) {
                done(err);
            });
        }).catch(function (err) {
            done(err);
        });
    });
    it("expect an object", function () {
        expect(obj).to.be.an("Object");
    });
    describe("composition of _id", function () {
        it("expect that _id is composed of 4 word", function () {
            expect(obj._id.split("_").length).that.equal(4);
        });
        it("expect that first word of _id is class data", function () {
            expect(obj._id.split("_")[0]).that.equal("data");
        });
        it("expect that second word of _id is serial 00000", function () {
            expect(obj._id.split("_")[1]).that.equal("00000");
        });
        it("expect that third word of _id is a number equal to createdAt", function () {
            expect(parseInt(obj._id.split("_")[2])).that.is.a("number").that.equal(obj.createdAt);
        });
        it("expect fourth word of _id is an uid", function () {
            expect(obj._id.split("_")[3]).that.is.a("string");
        });
        it("expect fourth word of _id is an uid of 5 characters", function () {
            expect(obj._id.split("_")[3].length).that.equal(5);
        });
    });
});
describe("test edit location object defined inside couchman", function () {
    var obj;
    before(function (done) {
        rpj.put('http://localhost:5985/test-db-location').then(function (d) {
            var CM = new CouchMan({ couch: "http://localhost:5985/test-db-location", class: "location" });
            var newobj = CM.gen();
            CM.create(newobj).then(function (_id) {
                CM.find(_id).then(function (obje) {
                    CM.update(obje).then(function () {
                        obj = obje;
                        done();
                    }).catch(function (err) {
                        done(err);
                    });
                }).catch(function (err) {
                    done(err);
                });
            }).catch(function (err) {
                done(err);
            });
        }).catch(function (err) {
            done(err);
        });
    });
    it("expect an object", function () {
        expect(obj).to.be.an("Object");
    });
    describe("composition of _id", function () {
        it("expect that _id is composed of 4 word", function () {
            expect(obj._id.split("_").length).that.equal(4);
        });
        it("expect that first word of _id is class location", function () {
            expect(obj._id.split("_")[0]).that.equal("location");
        });
        it("expect that second word of _id is serial 00000", function () {
            expect(obj._id.split("_")[1]).that.equal("00000");
        });
        it("expect that third word of _id is a number equal to createdAt", function () {
            expect(parseInt(obj._id.split("_")[2])).that.is.a("number").that.equal(obj.createdAt);
        });
        it("expect fourth word of _id is an uid", function () {
            expect(obj._id.split("_")[3]).that.is.a("string");
        });
        it("expect fourth word of _id is an uid of 5 characters", function () {
            expect(obj._id.split("_")[3].length).that.equal(5);
        });
    });
});
describe("test take", function () {
    var objs = [];
    before(function (done) {
        rpj.put('http://localhost:5985/test-db-take').then(function (d) {
            var CM = new CouchMan({ couch: "http://localhost:5985/test-db-take", class: "take" });
            var newobj = CM.gen();
            CM.create(newobj).then(function (_id) {
                CM.create(CM.gen()).then(function (_id) {
                    CM.take().then(function (objects) {
                        objs = objects;
                        done();
                    }).catch(function (err) {
                        done(err);
                    });
                }).catch(function (err) {
                    done(err);
                });
            }).catch(function (err) {
                done(err);
            });
        }).catch(function (err) {
            done(err);
        });
    });
    it("expect an Array", function () {
        expect(objs).to.be.an("Array");
    });
    describe("composition of _id", function () {
        var obj = objs[0];
        it("expect that _id is composed of 4 word", function () {
            expect(obj._id.split("_").length).that.equal(4);
        });
        it("expect that first word of _id is class location", function () {
            expect(obj._id.split("_")[0]).that.equal("location");
        });
        it("expect that second word of _id is serial 00000", function () {
            expect(obj._id.split("_")[1]).that.equal("00000");
        });
        it("expect that third word of _id is a number equal to createdAt", function () {
            expect(parseInt(obj._id.split("_")[2])).that.is.a("number").that.equal(obj.createdAt);
        });
        it("expect fourth word of _id is an uid", function () {
            expect(obj._id.split("_")[3]).that.is.a("string");
        });
        it("expect fourth word of _id is an uid of 5 characters", function () {
            expect(obj._id.split("_")[3].length).that.equal(5);
        });
    });
});
after(function (done) {
    exec("rm -rf .db", function () {
        done();
        process.exit(0);
    });
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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LEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUUxRixDQUFDLENBQUMsQ0FBQztRQUNILEVBQUUsQ0FBQyxxQ0FBcUMsRUFBRTtZQUV0QyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUV0RCxDQUFDLENBQUMsQ0FBQztRQUNILEVBQUUsQ0FBQyxxREFBcUQsRUFBRTtZQUV0RCxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUV2RCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBS1AsQ0FBQyxDQUFDLENBQUM7QUFJSCxLQUFLLENBQUMsVUFBUyxJQUFJO0lBQ2YsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUNmLElBQUksRUFBRSxDQUFDO1FBQ1AsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUNuQixDQUFDLENBQUMsQ0FBQTtBQUNOLENBQUMsQ0FBQyxDQUFBIiwiZmlsZSI6InRlc3QvbWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0ICogYXMgbW9jaGEgZnJvbSBcIm1vY2hhXCI7XG5pbXBvcnQgKiBhcyBjaGFpIGZyb20gXCJjaGFpXCI7XG5pbXBvcnQgKiBhcyBjaGlsZF9wcm9jZXNzIGZyb20gXCJjaGlsZF9wcm9jZXNzXCI7XG5cbmxldCBleGVjID0gY2hpbGRfcHJvY2Vzcy5leGVjO1xuXG5sZXQgcnBqID0gcmVxdWlyZShcInJlcXVlc3QtcHJvbWlzZS1qc29uXCIpO1xubGV0IGV4cGVjdCA9IGNoYWkuZXhwZWN0XG5cbmltcG9ydCBDb3VjaE1hbiA9IHJlcXVpcmUoXCIuLi9pbmRleFwiKTtcbmltcG9ydCBjb3VjaE9iaiA9IHJlcXVpcmUoXCIuLi8uLi9jb3VjaG9iamVjdFwiKTsgLy90byBiZSBjaGFuZ2VkISEhISEhISEhIVxubGV0IHN0YXJ0UG91Y2hTZXJ2ZXIgPSByZXF1aXJlKCdzcGF3bi1wb3VjaGRiLXNlcnZlcicpO1xuXG5cbmJlZm9yZShmdW5jdGlvbihkb25lKSB7XG5cbiAgICBleGVjKFwicm0gLXJmIC5kYlwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgc3RhcnRQb3VjaFNlcnZlcih7XG4gICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICBmaWxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBsb2c6IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZTogZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yLCBwb3VjaCkge1xuICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgZG9uZShlcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRvbmUoKTtcblxuXG5cbiAgICAgICAgfSlcblxuICAgIH0pXG5cbn0pXG5cbmRlc2NyaWJlKFwidGVzdCBuZXcgZXZlbnQgY3JlYXRpb25cIiwgZnVuY3Rpb24oKSB7XG4gICAgbGV0IG9iajtcbiAgICBiZWZvcmUoZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICBycGoucHV0KCdodHRwOi8vbG9jYWxob3N0OjU5ODUvdGVzdC1kYi1jcmVhdGUnKS50aGVuKGZ1bmN0aW9uKGQpIHtcblxuICAgICAgICAgICAgbGV0IENNID0gbmV3IENvdWNoTWFuKHsgY291Y2g6IFwiaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItY3JlYXRlXCIgfSk7XG5cbiAgICAgICAgICAgIGxldCBuZXdvYmogPSBDTS5nZW4oeyBjbGFzczogXCJldmVudFwiIH0pO1xuXG4gICAgICAgICAgICBDTS5jcmVhdGUobmV3b2JqKS50aGVuKGZ1bmN0aW9uKF9pZCkge1xuXG4gICAgICAgICAgICAgICAgQ00uZmluZChfaWQpLnRoZW4oZnVuY3Rpb24ob2JqZTogY291Y2hPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqID0gb2JqZTtcbiAgICAgICAgICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgZG9uZShlcnIpXG4gICAgICAgICAgICB9KVxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGRvbmUoZXJyKVxuICAgICAgICB9KVxuXG5cblxuICAgIH0pXG4gICAgaXQoXCJleHBlY3QgYW4gb2JqZWN0XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3Qob2JqKS50by5iZS5hbihcIk9iamVjdFwiKTtcbiAgICB9KTtcblxuXG4gICAgZGVzY3JpYmUoXCJjb21wb3NpdGlvbiBvZiBfaWRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCBfaWQgaXMgY29tcG9zZWQgb2YgNCB3b3JkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIikubGVuZ3RoKS50aGF0LmVxdWFsKDQpO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgZmlyc3Qgd29yZCBvZiBfaWQgaXMgY2xhc3MgZXZlbnRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVswXSkudGhhdC5lcXVhbChcImV2ZW50XCIpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCB0aGF0IHNlY29uZCB3b3JkIG9mIF9pZCBpcyBzZXJpYWwgMDAwMDBcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVsxXSkudGhhdC5lcXVhbChcIjAwMDAwXCIpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCB0aGF0IHRoaXJkIHdvcmQgb2YgX2lkIGlzIGEgbnVtYmVyIGVxdWFsIHRvIGNyZWF0ZWRBdFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KHBhcnNlSW50KG9iai5faWQuc3BsaXQoXCJfXCIpWzJdKSkudGhhdC5pcy5hKFwibnVtYmVyXCIpLnRoYXQuZXF1YWwob2JqLmNyZWF0ZWRBdCk7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwiZXhwZWN0IGZvdXJ0aCB3b3JkIG9mIF9pZCBpcyBhbiB1aWRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVszXSkudGhhdC5pcy5hKFwic3RyaW5nXCIpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCBmb3VydGggd29yZCBvZiBfaWQgaXMgYW4gdWlkIG9mIDUgY2hhcmFjdGVyc1wiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpWzNdLmxlbmd0aCkudGhhdC5lcXVhbCg1KTtcblxuICAgICAgICB9KTtcbiAgICB9KTtcblxuXG5cblxufSk7XG5cblxuZGVzY3JpYmUoXCJ0ZXN0IGVkaXQgZXZlbnQgb2JqZWN0XCIsIGZ1bmN0aW9uKCkge1xuICAgIGxldCBvYmo7XG4gICAgYmVmb3JlKGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgcnBqLnB1dCgnaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItZWRpdCcpLnRoZW4oZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgbGV0IENNID0gbmV3IENvdWNoTWFuKHsgY291Y2g6IFwiaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItZWRpdFwiIH0pO1xuXG4gICAgICAgICAgICBsZXQgbmV3b2JqID0gQ00uZ2VuKHsgY2xhc3M6IFwiZXZlbnRcIiB9KTtcblxuICAgICAgICAgICAgQ00uY3JlYXRlKG5ld29iaikudGhlbihmdW5jdGlvbihfaWQpIHtcblxuICAgICAgICAgICAgICAgIENNLmZpbmQoX2lkKS50aGVuKGZ1bmN0aW9uKG9iamU6IGNvdWNoT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIENNLnVwZGF0ZShvYmplKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqID0gb2JqZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUoZXJyKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIGl0KFwiZXhwZWN0IGFuIG9iamVjdFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZXhwZWN0KG9iaikudG8uYmUuYW4oXCJPYmplY3RcIik7XG4gICAgfSk7XG5cblxuICAgIGRlc2NyaWJlKFwiY29tcG9zaXRpb24gb2YgX2lkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgX2lkIGlzIGNvbXBvc2VkIG9mIDQgd29yZFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpLmxlbmd0aCkudGhhdC5lcXVhbCg0KTtcblxuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImV4cGVjdCB0aGF0IGZpcnN0IHdvcmQgb2YgX2lkIGlzIGNsYXNzIGV2ZW50XCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMF0pLnRoYXQuZXF1YWwoXCJldmVudFwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCBzZWNvbmQgd29yZCBvZiBfaWQgaXMgc2VyaWFsIDAwMDAwXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMV0pLnRoYXQuZXF1YWwoXCIwMDAwMFwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCB0aGlyZCB3b3JkIG9mIF9pZCBpcyBhIG51bWJlciBlcXVhbCB0byBjcmVhdGVkQXRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChwYXJzZUludChvYmouX2lkLnNwbGl0KFwiX1wiKVsyXSkpLnRoYXQuaXMuYShcIm51bWJlclwiKS50aGF0LmVxdWFsKG9iai5jcmVhdGVkQXQpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCBmb3VydGggd29yZCBvZiBfaWQgaXMgYW4gdWlkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbM10pLnRoYXQuaXMuYShcInN0cmluZ1wiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgZm91cnRoIHdvcmQgb2YgX2lkIGlzIGFuIHVpZCBvZiA1IGNoYXJhY3RlcnNcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVszXS5sZW5ndGgpLnRoYXQuZXF1YWwoNSk7XG5cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbn0pO1xuXG5cbmRlc2NyaWJlKFwidGVzdCBlZGl0IGRhdGEgb2JqZWN0XCIsIGZ1bmN0aW9uKCkge1xuICAgIGxldCBvYmo7XG4gICAgYmVmb3JlKGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgcnBqLnB1dCgnaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItZGF0YScpLnRoZW4oZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgbGV0IENNID0gbmV3IENvdWNoTWFuKHsgY291Y2g6IFwiaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItZGF0YVwiIH0pO1xuXG4gICAgICAgICAgICBsZXQgbmV3b2JqID0gQ00uZ2VuKCk7XG5cbiAgICAgICAgICAgIENNLmNyZWF0ZShuZXdvYmopLnRoZW4oZnVuY3Rpb24oX2lkKSB7XG5cbiAgICAgICAgICAgICAgICBDTS5maW5kKF9pZCkudGhlbihmdW5jdGlvbihvYmplOiBjb3VjaE9iaikge1xuICAgICAgICAgICAgICAgICAgICBDTS51cGRhdGUob2JqZSkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IG9iamU7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZG9uZShlcnIpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgZG9uZShlcnIpXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIGl0KFwiZXhwZWN0IGFuIG9iamVjdFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZXhwZWN0KG9iaikudG8uYmUuYW4oXCJPYmplY3RcIik7XG4gICAgfSk7XG5cblxuICAgIGRlc2NyaWJlKFwiY29tcG9zaXRpb24gb2YgX2lkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgX2lkIGlzIGNvbXBvc2VkIG9mIDQgd29yZFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpLmxlbmd0aCkudGhhdC5lcXVhbCg0KTtcblxuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImV4cGVjdCB0aGF0IGZpcnN0IHdvcmQgb2YgX2lkIGlzIGNsYXNzIGRhdGFcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVswXSkudGhhdC5lcXVhbChcImRhdGFcIik7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgc2Vjb25kIHdvcmQgb2YgX2lkIGlzIHNlcmlhbCAwMDAwMFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpWzFdKS50aGF0LmVxdWFsKFwiMDAwMDBcIik7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgdGhpcmQgd29yZCBvZiBfaWQgaXMgYSBudW1iZXIgZXF1YWwgdG8gY3JlYXRlZEF0XCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3QocGFyc2VJbnQob2JqLl9pZC5zcGxpdChcIl9cIilbMl0pKS50aGF0LmlzLmEoXCJudW1iZXJcIikudGhhdC5lcXVhbChvYmouY3JlYXRlZEF0KTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgZm91cnRoIHdvcmQgb2YgX2lkIGlzIGFuIHVpZFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpWzNdKS50aGF0LmlzLmEoXCJzdHJpbmdcIik7XG5cbiAgICAgICAgfSk7XG4gICAgICAgIGl0KFwiZXhwZWN0IGZvdXJ0aCB3b3JkIG9mIF9pZCBpcyBhbiB1aWQgb2YgNSBjaGFyYWN0ZXJzXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbM10ubGVuZ3RoKS50aGF0LmVxdWFsKDUpO1xuXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG5cblxuXG59KTtcblxuZGVzY3JpYmUoXCJ0ZXN0IGVkaXQgbG9jYXRpb24gb2JqZWN0IGRlZmluZWQgaW5zaWRlIGNvdWNobWFuXCIsIGZ1bmN0aW9uKCkge1xuICAgIGxldCBvYmo7XG4gICAgYmVmb3JlKGZ1bmN0aW9uKGRvbmUpIHtcbiAgICAgICAgcnBqLnB1dCgnaHR0cDovL2xvY2FsaG9zdDo1OTg1L3Rlc3QtZGItbG9jYXRpb24nKS50aGVuKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIGxldCBDTSA9IG5ldyBDb3VjaE1hbih7IGNvdWNoOiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTk4NS90ZXN0LWRiLWxvY2F0aW9uXCIsIGNsYXNzOiBcImxvY2F0aW9uXCIgfSk7XG5cbiAgICAgICAgICAgIGxldCBuZXdvYmogPSBDTS5nZW4oKTtcblxuICAgICAgICAgICAgQ00uY3JlYXRlKG5ld29iaikudGhlbihmdW5jdGlvbihfaWQpIHtcblxuICAgICAgICAgICAgICAgIENNLmZpbmQoX2lkKS50aGVuKGZ1bmN0aW9uKG9iamU6IGNvdWNoT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIENNLnVwZGF0ZShvYmplKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqID0gb2JqZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUoZXJyKVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIGl0KFwiZXhwZWN0IGFuIG9iamVjdFwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZXhwZWN0KG9iaikudG8uYmUuYW4oXCJPYmplY3RcIik7XG4gICAgfSk7XG5cblxuICAgIGRlc2NyaWJlKFwiY29tcG9zaXRpb24gb2YgX2lkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgX2lkIGlzIGNvbXBvc2VkIG9mIDQgd29yZFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpLmxlbmd0aCkudGhhdC5lcXVhbCg0KTtcblxuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImV4cGVjdCB0aGF0IGZpcnN0IHdvcmQgb2YgX2lkIGlzIGNsYXNzIGxvY2F0aW9uXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMF0pLnRoYXQuZXF1YWwoXCJsb2NhdGlvblwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCBzZWNvbmQgd29yZCBvZiBfaWQgaXMgc2VyaWFsIDAwMDAwXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMV0pLnRoYXQuZXF1YWwoXCIwMDAwMFwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCB0aGlyZCB3b3JkIG9mIF9pZCBpcyBhIG51bWJlciBlcXVhbCB0byBjcmVhdGVkQXRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChwYXJzZUludChvYmouX2lkLnNwbGl0KFwiX1wiKVsyXSkpLnRoYXQuaXMuYShcIm51bWJlclwiKS50aGF0LmVxdWFsKG9iai5jcmVhdGVkQXQpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCBmb3VydGggd29yZCBvZiBfaWQgaXMgYW4gdWlkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbM10pLnRoYXQuaXMuYShcInN0cmluZ1wiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgZm91cnRoIHdvcmQgb2YgX2lkIGlzIGFuIHVpZCBvZiA1IGNoYXJhY3RlcnNcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVszXS5sZW5ndGgpLnRoYXQuZXF1YWwoNSk7XG5cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cblxuXG5cbn0pO1xuXG5cbmRlc2NyaWJlKFwidGVzdCB0YWtlXCIsIGZ1bmN0aW9uKCkge1xuICAgIGxldCBvYmpzPVtdO1xuICAgIGJlZm9yZShmdW5jdGlvbihkb25lKSB7XG4gICAgICAgIHJwai5wdXQoJ2h0dHA6Ly9sb2NhbGhvc3Q6NTk4NS90ZXN0LWRiLXRha2UnKS50aGVuKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgIGxldCBDTSA9IG5ldyBDb3VjaE1hbih7IGNvdWNoOiBcImh0dHA6Ly9sb2NhbGhvc3Q6NTk4NS90ZXN0LWRiLXRha2VcIiwgY2xhc3M6IFwidGFrZVwiIH0pO1xuXG4gICAgICAgICAgICBsZXQgbmV3b2JqID0gQ00uZ2VuKCk7XG5cbiAgICAgICAgICAgIENNLmNyZWF0ZShuZXdvYmopLnRoZW4oZnVuY3Rpb24oX2lkKSB7XG5cbiAgICAgICAgICAgIENNLmNyZWF0ZShDTS5nZW4oKSkudGhlbihmdW5jdGlvbihfaWQpIHtcblxuICAgICAgICAgICAgICAgIENNLnRha2UoKS50aGVuKGZ1bmN0aW9uKG9iamVjdHM6IGNvdWNoT2JqW10pIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqcyA9IG9iamVjdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZG9uZShlcnIpXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIGRvbmUoZXJyKVxuICAgICAgICAgICAgfSlcblxuXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBkb25lKGVycilcbiAgICAgICAgfSlcbiAgICB9KVxuICAgIGl0KFwiZXhwZWN0IGFuIEFycmF5XCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBleHBlY3Qob2JqcykudG8uYmUuYW4oXCJBcnJheVwiKTtcbiAgICB9KTtcblxuXG4gICAgZGVzY3JpYmUoXCJjb21wb3NpdGlvbiBvZiBfaWRcIiwgZnVuY3Rpb24oKSB7XG5sZXQgb2JqPW9ianNbMF07XG4gICAgICAgIGl0KFwiZXhwZWN0IHRoYXQgX2lkIGlzIGNvbXBvc2VkIG9mIDQgd29yZFwiLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgZXhwZWN0KG9iai5faWQuc3BsaXQoXCJfXCIpLmxlbmd0aCkudGhhdC5lcXVhbCg0KTtcblxuICAgICAgICB9KTtcblxuICAgICAgICBpdChcImV4cGVjdCB0aGF0IGZpcnN0IHdvcmQgb2YgX2lkIGlzIGNsYXNzIGxvY2F0aW9uXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMF0pLnRoYXQuZXF1YWwoXCJsb2NhdGlvblwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCBzZWNvbmQgd29yZCBvZiBfaWQgaXMgc2VyaWFsIDAwMDAwXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbMV0pLnRoYXQuZXF1YWwoXCIwMDAwMFwiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgdGhhdCB0aGlyZCB3b3JkIG9mIF9pZCBpcyBhIG51bWJlciBlcXVhbCB0byBjcmVhdGVkQXRcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChwYXJzZUludChvYmouX2lkLnNwbGl0KFwiX1wiKVsyXSkpLnRoYXQuaXMuYShcIm51bWJlclwiKS50aGF0LmVxdWFsKG9iai5jcmVhdGVkQXQpO1xuXG4gICAgICAgIH0pO1xuICAgICAgICBpdChcImV4cGVjdCBmb3VydGggd29yZCBvZiBfaWQgaXMgYW4gdWlkXCIsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBleHBlY3Qob2JqLl9pZC5zcGxpdChcIl9cIilbM10pLnRoYXQuaXMuYShcInN0cmluZ1wiKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgaXQoXCJleHBlY3QgZm91cnRoIHdvcmQgb2YgX2lkIGlzIGFuIHVpZCBvZiA1IGNoYXJhY3RlcnNcIiwgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGV4cGVjdChvYmouX2lkLnNwbGl0KFwiX1wiKVszXS5sZW5ndGgpLnRoYXQuZXF1YWwoNSk7XG5cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cblxuXG5cbn0pO1xuXG5cblxuYWZ0ZXIoZnVuY3Rpb24oZG9uZSkge1xuICAgIGV4ZWMoXCJybSAtcmYgLmRiXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICBkb25lKCk7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgwKVxuICAgIH0pXG59KSJdfQ==
